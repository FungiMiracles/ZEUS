{% extends 'base_layout.html' %}
{% block title %}Formularz państwa{% endblock %}

{% block content %}
<style>
  body {
    font-family: 'Arial', sans-serif;
    background: radial-gradient(circle at top left, #f09433, #e6683c, #dc2743, #cc2366, #bc1888);
    color: #fff;
  }

  hr { border: none; height: 1px; background-color: rgba(255,255,255,0.3); }

  h2 {
    margin: 10px 0 10px 30px;
    font-weight: 700;
    color: #fff;
    text-shadow: 1px 1px 4px rgba(0,0,0,0.5);
  }

  p.subtitle {
    margin: -20px 0 20px 30px;
    font-style: italic;
    color: rgba(255,255,255,0.8);
  }

  .main-container { display: flex; gap: 30px; margin: 20px 30px; flex-wrap: wrap; }

  .column-left, .column-right {
    background: rgba(0,0,0,0.4);
    border-radius: 12px;
    padding: 12px;
  }

  .column-left { flex: 1; min-width: 350px; }
  .column-right { flex: 3; min-width: 600px; }

  table {
    width: 100%;
    border-collapse: collapse;
    background: rgba(0,0,0,0.2);
    border-radius: 8px;
  }

  thead th {
    background: linear-gradient(90deg, #f09433, #bc1888);
    color: white;
    font-weight: 700;
    font-size: 1.1em;
    padding: 10px;
    text-align: center;
  }

  tbody td {
    padding: 10px;
    color: #fff;
  }

  tbody tr:nth-child(even) { background-color: rgba(255,255,255,0.05); }
  tbody tr:nth-child(odd) { background-color: rgba(255,255,255,0.08); }

  .flag-img, .map-img {
    max-height: 130px;
    max-width: 100%;
    border-radius: 6px;
    border: 1px solid rgba(255,255,255,0.3);
  }

  .description-box {
    padding: 10px;
    font-size: 0.95em;
    line-height: 1.6;
  }

  .no-description {
    text-align: center;
    color: rgba(255,255,255,0.7);
    font-style: italic;
    padding: 40px;
  }
</style>

<hr>
<p style="text-align:center; margin:15px 0;">Formularz państwa</p>
<hr>

<h2>{{ p.panstwo_nazwa }}</h2>
<p class="subtitle">{{ p.panstwo_pelna_nazwa }}</p>
<hr>

<div class="main-container">
  <div class="column-left">
    <!-- Tabela Informacje o państwie -->
    <table>
      <thead>
        <tr><th colspan="3">Informacje o państwie</th></tr>
      </thead>
      <tbody>
        <tr>
          <td style="font-weight:bold;">Flaga:</td>
          <td colspan="2" style="text-align:center;">
            {% set flag_path = 'flags/' + p.panstwo_nazwa|replace(' ', '_') + '.jpg' %}
            <img src="{{ url_for('static', filename=flag_path) }}"
                 onerror='this.src="{{ url_for("static", filename="flags/default.png") }}"'
                 alt="Flaga {{ p.panstwo_nazwa }}"
                 class="flag-img">
          </td>
        </tr>
        <tr>
          <td style="font-weight:bold;">Mapa:</td>
          <td colspan="2" style="text-align:center;">
            {% set mapa_path = 'maps/' + p.panstwo_nazwa|replace(' ', '_') + '.jpg' %}
            <img src="{{ url_for('static', filename=mapa_path) }}"
                 onerror="this.src='{{ url_for('static', filename='maps/default.png') }}'"
                 alt="Mapa {{ p.panstwo_nazwa }}"
                 class="map-img">
          </td>
        </tr>
        {% for label, value in [
          ('Kontynent:', p.kontynent),
          ('Ustrój polityczny:', p.panstwo_ustroj),
          ('Stolica:', p.panstwo_stolica),
          ('Populacja:', "{:,}".format(p.panstwo_populacja).replace(",", " ") ~ " osób"),
          ('Powierzchnia:', "{:,}".format(p.panstwo_powierzchnia).replace(",", " ") ~ " km²"),
          ('Waluta:', p.panstwo_waluta),
          ('Język urzędowy:', p.panstwo_jezyk),
          ('Religia dominująca:', p.panstwo_religia),
          ('PKB:', "{:,}".format(p.panstwo_PKB).replace(",", " ") ~ " ROI"),
          ('PKB na mieszkańca:', "{:,}".format(p.panstwo_PKB_per_capita).replace(",", " ") ~ " ROI")
        ] %}
        <tr>
          <td style="font-weight:bold;">{{ label }}</td>
          <td colspan="2">{{ value }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <!-- Tabela Największe miasta -->
    <table>
      <thead>
        <tr><th colspan="3">Największe miasta</th></tr>
      </thead>
      <tbody>
        {% if miasta %}
          {% for m in miasta %}
          <tr>
            <td colspan="2" style="font-weight:bold;">{{ m.miasto_nazwa }}</td>
            <td style="font-weight:bold; text-align:right;">{{ "{:,}".format(m.miasto_populacja).replace(',', ' ') }}</td>
          </tr>
          {% endfor %}
        {% else %}
          <tr><td colspan="3" style="text-align:center;">Brak danych o miastach.</td></tr>
        {% endif %}
      </tbody>
    </table>
  </div>

  <div class="column-right">
    <table>
      <thead>
        <tr><th>Informacje szczegółowe</th></tr>
      </thead>
      <tbody>
        <tr>
          <td>
            {% if opis %}
              <div class="description-box">{{ opis | safe }}</div>
            {% else %}
              <p class="no-description">Brak dostępnego opisu dla tego państwa.</p>
            {% endif %}
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

{% endblock %}
